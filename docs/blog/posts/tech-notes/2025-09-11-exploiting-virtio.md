---
date: 2025-09-11
categories:
    - tech-notes
draft: true
---

# Exploiting VirtIO Kernel Driver Vulnerabilities

You may be famililar with exploiting kernel driver vulnerabilities from the user
space, but what about from the hypervisor? The blog presents two examples of
[CVE-2021-47613](https://nvd.nist.gov/vuln/detail/cve-2021-47613) and
[CVE-2024-53082](https://nvd.nist.gov/vuln/detail/CVE-2024-53082).

<!-- more -->

|CVE|Bug Fix Commit|Description|
|:---:|:---:|:---:|
|CVE-2021-47613|[b503de23](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b503de239f62eca898cfb7e820d9a35499137d22)|The driver wrongly assumes the notify callback means all buffers are done, but it may arrive with none or only some completed.|
|CVE-2024-53082|[3f7d9c19](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3f7d9c1964fcd16d02a8a9d4fd6f6cb60c4cc530)|The driver wrongly omits a hash_key_length check in virtnet_probe(), which can cause out-of-bounds access when setting or reading the hash key.|

## CVE-2024-53082

Download and compile the Linux kernel 5.15

```
wget https://www.kernel.org/pub/linux/kernel/v5.x/linux-5.15.tar.xz
tar xf linux-5.15.tar.xz

sudo apt install -y build-essential libncurses-dev \
    bison flex libssl-dev libelf-dev fakeroot dwarves

cd linux-5.15
# Add -Wno-use-after-free to the tools/lib/subcmd/Makefile line 22
make defconfig
fakeroot make # it takes time
make bzImage
```

Launch the Linux kernel with QEMU/KVM

```

```



